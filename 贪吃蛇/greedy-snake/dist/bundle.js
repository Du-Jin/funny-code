(()=>{"use strict";const e=function(){function e(){}return e.debounceDecorator=function(e,t){var n;return function(o){null!==n&&clearTimeout(n),n=window.setTimeout((function(){e(o)}),t)}},e.CEIL_SIZE=10,e.N=30,e}(),t=function(){function t(){var t=this;this.step=function(){switch(t.refreshBody(),t.direction){case"up":t.stepUp();break;case"down":t.stepDown();break;case"left":t.stepLeft();break;case"right":t.stepRight();break;default:t.direction}},this.checkTouchSelf=function(){for(var n=t.element.children,o=n.length-1;o>0;o--){var r=n[o];if(t.X*e.CEIL_SIZE===r.offsetLeft&&t.Y*e.CEIL_SIZE===r.offsetTop)return!0}return!1},this.element=document.getElementById("snake"),this.head=document.getElementById("snake-head"),this.head.style.left="0px",this.head.style.top="0px",this.direction="right"}return Object.defineProperty(t.prototype,"X",{get:function(){return Math.floor(this.head.offsetLeft/e.CEIL_SIZE)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Y",{get:function(){return Math.floor(this.head.offsetTop/e.CEIL_SIZE)},enumerable:!1,configurable:!0}),t.prototype.stepLeft=function(){var t=this.head.offsetLeft-e.CEIL_SIZE;this.head.style.left=t+"px"},t.prototype.stepRight=function(){var t=this.head.offsetLeft+e.CEIL_SIZE;this.head.style.left=t+"px"},t.prototype.stepUp=function(){var t=this.head.offsetTop-e.CEIL_SIZE;this.head.style.top=t+"px"},t.prototype.stepDown=function(){var t=this.head.offsetTop+e.CEIL_SIZE;this.head.style.top=t+"px"},t.prototype.refreshBody=function(){var e=this.element.children;if(!(e.length<=1))for(var t=e.length-1;t>0;t--){var n=e[t-1],o=e[t],r=n.offsetLeft,i=n.offsetTop;o.style.left=r+"px",o.style.top=i+"px"}},t.prototype.grow=function(){var t=this.element.lastElementChild,n=document.createElement("div");n.id="snake-body";var o=t.offsetLeft,r=t.offsetTop;switch(this.direction){case"up":r+=e.CEIL_SIZE;break;case"down":r-=e.CEIL_SIZE;break;case"left":o+=e.CEIL_SIZE;break;case"right":o-=e.CEIL_SIZE;break;default:this.direction}n.style.left=o+"px",n.style.top=r+"px",this.element.appendChild(n)},t}(),n=function(){function t(){this.element=document.getElementById("food")}return Object.defineProperty(t.prototype,"X",{get:function(){return Math.floor(this.element.offsetLeft/e.CEIL_SIZE)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Y",{get:function(){return Math.floor(this.element.offsetTop/e.CEIL_SIZE)},enumerable:!1,configurable:!0}),t.prototype.change=function(){var t=10*Math.floor(Math.random()*(e.N-1)),n=10*Math.floor(Math.random()*(e.N-1));this.element.style.left=t+"px",this.element.style.top=n+"px"},t}();var o=new Map;o.set("ArrowUp","up"),o.set("ArrowDown","down"),o.set("ArrowLeft","left"),o.set("ArrowRight","right"),(new function(){var r=this;this.moveSnake=function(){var e=Number.parseInt(r.levelElement.innerText),t=setInterval((function(){r.snake.step(),r.checkScore(),r.checkTouchWall(),r.snake.checkTouchSelf()&&(r.isLive=!1),!1===r.isLive&&(document.getElementById("game-status").innerText="game failed!",clearInterval(t))}),300-20*(e-1))},this.checkScore=function(){var e=r.food.X,t=r.food.Y,n=r.snake.X,o=r.snake.Y;if(e===n&&t===o){var i=Number.parseInt(r.scoreElement.innerText)+1;if(r.scoreElement.innerText=String(i),i%10==0){var s=Number.parseInt(r.levelElement.innerText)+1;s<=10&&(r.levelElement.innerText=String(s))}r.snake.grow(),r.food.change()}},this.checkTouchWall=function(){var t=r.snake.X,n=r.snake.Y;(t>=e.N||t<0||n>=e.N||n<0)&&(r.isLive=!1)},this.play=function(){var t=r;r.moveSnake();var n=e.debounceDecorator((function(e){var n=e.key;"up"!==t.snake.direction&&"down"!==t.snake.direction||"ArrowLeft"!==n&&"ArrowRight"!==n||(t.snake.direction=o.get(n)),"left"!==t.snake.direction&&"right"!==t.snake.direction||"ArrowUp"!==n&&"ArrowDown"!==n||(t.snake.direction=o.get(n))}),100);document.addEventListener("keydown",n)},this.snake=new t,this.scoreElement=document.getElementById("score"),this.levelElement=document.getElementById("level"),this.food=new n,this.isLive=!0}).play()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJwYWNrLXRzLy4vc3JjL2NvbW1vbi50cyIsIndlYnBhY2s6Ly93ZWJwYWNrLXRzLy4vc3JjL3NuYWtlLnRzIiwid2VicGFjazovL3dlYnBhY2stdHMvLi9zcmMvZm9vZC50cyIsIndlYnBhY2s6Ly93ZWJwYWNrLXRzLy4vc3JjL2dhbWUudHMiLCJ3ZWJwYWNrOi8vd2VicGFjay10cy8uL3NyYy9pbmRleC50cyJdLCJuYW1lcyI6WyJkZWJvdW5jZURlY29yYXRvciIsImZuIiwiZGVsYXkiLCJ0aW1lciIsImV2ZW50IiwiY2xlYXJUaW1lb3V0Iiwid2luZG93Iiwic2V0VGltZW91dCIsIkNFSUxfU0laRSIsIk4iLCJzdGVwIiwicmVmcmVzaEJvZHkiLCJkaXJlY3Rpb24iLCJzdGVwVXAiLCJzdGVwRG93biIsInN0ZXBMZWZ0Iiwic3RlcFJpZ2h0IiwiY2hlY2tUb3VjaFNlbGYiLCJib2R5U2VjdGlvbnMiLCJlbGVtZW50IiwiY2hpbGRyZW4iLCJpIiwibGVuZ3RoIiwic2VjIiwiWCIsIm9mZnNldExlZnQiLCJZIiwib2Zmc2V0VG9wIiwidGhpcyIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJoZWFkIiwic3R5bGUiLCJsZWZ0IiwidG9wIiwiTWF0aCIsImZsb29yIiwiaGVhZE5ld1giLCJoZWFkTmV3WSIsIm5leHQiLCJjdXJyZW50IiwibmV4dFgiLCJuZXh0WSIsImdyb3ciLCJjdXJyTGFzdFNlY3Rpb24iLCJsYXN0RWxlbWVudENoaWxkIiwibmV3U2VjdGlvbiIsImNyZWF0ZUVsZW1lbnQiLCJpZCIsIm5ld1NlY1giLCJuZXdTZWNZIiwiYXBwZW5kQ2hpbGQiLCJjaGFuZ2UiLCJuZXdYIiwicmFuZG9tIiwibmV3WSIsIm1hcCIsIk1hcCIsInNldCIsIm1vdmVTbmFrZSIsImxldmVsIiwiTnVtYmVyIiwicGFyc2VJbnQiLCJsZXZlbEVsZW1lbnQiLCJpbm5lclRleHQiLCJzZXRJbnRlcnZhbCIsInNuYWtlIiwiY2hlY2tTY29yZSIsImNoZWNrVG91Y2hXYWxsIiwiaXNMaXZlIiwiY2xlYXJJbnRlcnZhbCIsImZvb2RYIiwiZm9vZCIsImZvb2RZIiwic25ha2VIZWFkWCIsInNuYWtlSGVhZFkiLCJuZXdTY29yZSIsInNjb3JlRWxlbWVudCIsIlN0cmluZyIsIm5ld0xldmVsIiwicGxheSIsInNlbGYiLCJrZXkiLCJnZXQiLCJhZGRFdmVudExpc3RlbmVyIl0sIm1hcHBpbmdzIjoibUJBZUEsUUFmQSx5QkFjQSxPQVhTLEVBQUFBLGtCQUFQLFNBQTBCQyxFQUFtQ0MsR0FDM0QsSUFBSUMsRUFDSixPQUFPLFNBQVNDLEdBQ0EsT0FBVkQsR0FDRkUsYUFBYUYsR0FFZkEsRUFBUUcsT0FBT0MsWUFBVyxXQUN4Qk4sRUFBR0csS0FDRkYsS0FWQSxFQUFBTSxVQUFZLEdBQ1osRUFBQUMsRUFBSSxHQVliLEVBZEEsR0MrSEEsRUEzSEEsV0FJRSx3QkErQkEsS0FBQUMsS0FBTyxXQUVMLE9BREEsRUFBS0MsY0FDRyxFQUFLQyxXQUNYLElBQUssS0FDSCxFQUFLQyxTQUNMLE1BRUYsSUFBSyxPQUNILEVBQUtDLFdBQ0wsTUFFRixJQUFLLE9BQ0gsRUFBS0MsV0FDTCxNQUVGLElBQUssUUFDSCxFQUFLQyxZQUNMLE1BRUYsUUFDa0MsRUFBS0osWUF1RDNDLEtBQUFLLGVBQWlCLFdBRWYsSUFEQSxJQUFJQyxFQUFlLEVBQUtDLFFBQVFDLFNBQ3ZCQyxFQUFJSCxFQUFhSSxPQUFPLEVBQUdELEVBQUksRUFBR0EsSUFBSyxDQUM5QyxJQUFJRSxFQUFNTCxFQUFhRyxHQUN2QixHQUFJLEVBQUtHLEVBQUksY0FBcUJELEVBQUlFLFlBQ2xDLEVBQUtDLEVBQUksY0FBcUJILEVBQUlJLFVBQ3BDLE9BQU8sRUFHWCxPQUFPLEdBbEhQQyxLQUFLVCxRQUFVVSxTQUFTQyxlQUFlLFNBQ3ZDRixLQUFLRyxLQUFPRixTQUFTQyxlQUFlLGNBQ3BDRixLQUFLRyxLQUFLQyxNQUFNQyxLQUFPLE1BQ3ZCTCxLQUFLRyxLQUFLQyxNQUFNRSxJQUFNLE1BQ3RCTixL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LE1BQU10RCxXQUFpRCxVQUF6QnFFLEVBQUtmLE1BQU10RCxXQUN0QyxZQUFSc0UsR0FBNkIsY0FBUkEsSUFDeEJELEVBQUtmLE1BQU10RCxVQUFZNEMsRUFBSTJCLElBQUlELE1BR2UsS0FFbERyRCxTQUFTdUQsaUJBQWlCLFVBQVduRixJQXhFckMyQixLQUFLc0MsTUFBUSxJQUFJLEVBQ2pCdEMsS0FBS2lELGFBQWVoRCxTQUFTQyxlQUFlLFNBQzVDRixLQUFLbUMsYUFBZWxDLFNBQVNDLGVBQWUsU0FDNUNGLEtBQUs0QyxLQUFPLElBQUksRUFDaEI1QyxLQUFLeUMsUUFBUyxJQ25CYlcsUSIsImZpbGUiOiJidW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBDb21tb24ge1xyXG4gIHN0YXRpYyBDRUlMX1NJWkUgPSAxMDsgIC8vIOavj+S4quWwj+WNleWFg+agvOS4ujEwcHhcclxuICBzdGF0aWMgTiA9IDMwOyAgLy8g5Y+v56e75Yqo5Yy65Z+f5Li6MzAqMzDnmoTnvZHmoLxcclxuICBzdGF0aWMgZGVib3VuY2VEZWNvcmF0b3IgKGZuIDogKGV2ZW50OiBLZXlib2FyZEV2ZW50KT0+dm9pZCwgZGVsYXk6IG51bWJlcikge1xyXG4gICAgbGV0IHRpbWVyIDogbnVtYmVyO1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uKGV2ZW50OiBLZXlib2FyZEV2ZW50KSB7XHJcbiAgICAgIGlmICh0aW1lciAhPT0gbnVsbCkge1xyXG4gICAgICAgIGNsZWFyVGltZW91dCh0aW1lcik7XHJcbiAgICAgIH1cclxuICAgICAgdGltZXIgPSB3aW5kb3cuc2V0VGltZW91dCgoKT0+e1xyXG4gICAgICAgIGZuKGV2ZW50KTtcclxuICAgICAgfSwgZGVsYXkpOyAgLy8gdHlwZXNjcmlwdOS4i3NldFRpbWVvdXTlh73mlbDov5Tlm57nsbvlnovmr5TovoPlpYfmgKrvvIzmiYDku6XmlLnnlKh3aW5kb3cuc2V0VGltZW91dO+8jOi/lOWbnuexu+Wei+S4um51bWJlcu+8jOS4unRpbWVyIElEXHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbmV4cG9ydCBkZWZhdWx0IENvbW1vbjsiLCJpbXBvcnQgQ29tbW9uIGZyb20gJy4vY29tbW9uJztcclxuXHJcbnR5cGUgRGlyZWN0aW9uID0gJ3VwJyB8ICdkb3duJyB8ICdsZWZ0JyB8ICdyaWdodCc7XHJcblxyXG5jbGFzcyBTbmFrZSB7XHJcbiAgZWxlbWVudDogSFRNTEVsZW1lbnQ7ICAgIC8vIOaVtOS4quibh+eahOWFg+e0oFxyXG4gIGhlYWQ6IEhUTUxFbGVtZW50OyAgICAgICAvLyDom4fnmoTlpLTpg6hcclxuICBkaXJlY3Rpb246IERpcmVjdGlvbjsgICAgLy8g5b2T5YmN56e75Yqo5pa55ZCRXHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICB0aGlzLmVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc25ha2UnKSBhcyBIVE1MRWxlbWVudDtcclxuICAgIHRoaXMuaGVhZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzbmFrZS1oZWFkJykgYXMgSFRNTEVsZW1lbnQ7XHJcbiAgICB0aGlzLmhlYWQuc3R5bGUubGVmdCA9ICcwcHgnO1xyXG4gICAgdGhpcy5oZWFkLnN0eWxlLnRvcCA9ICcwcHgnO1xyXG4gICAgdGhpcy5kaXJlY3Rpb24gPSAncmlnaHQnO1xyXG4gIH1cclxuICBnZXQgWCgpIDogbnVtYmVye1xyXG4gICAgY29uc3QgcmVzID0gTWF0aC5mbG9vcih0aGlzLmhlYWQub2Zmc2V0TGVmdCAvIENvbW1vbi5DRUlMX1NJWkUpO1xyXG4gICAgcmV0dXJuIHJlcztcclxuICB9XHJcbiAgZ2V0IFkoKSA6IG51bWJlcntcclxuICAgIGNvbnN0IHJlcyA9IE1hdGguZmxvb3IodGhpcy5oZWFkLm9mZnNldFRvcCAvIENvbW1vbi5DRUlMX1NJWkUpO1xyXG4gICAgcmV0dXJuIHJlcztcclxuICB9XHJcbiAgc3RlcExlZnQoKSA6IHZvaWQge1xyXG4gICAgY29uc3QgaGVhZE5ld1ggPSB0aGlzLmhlYWQub2Zmc2V0TGVmdCAtIENvbW1vbi5DRUlMX1NJWkU7XHJcbiAgICB0aGlzLmhlYWQuc3R5bGUubGVmdCA9IGAke2hlYWROZXdYfXB4YDtcclxuICB9XHJcbiAgc3RlcFJpZ2h0KCkgOiB2b2lkIHtcclxuICAgIGNvbnN0IGhlYWROZXdYID0gdGhpcy5oZWFkLm9mZnNldExlZnQgKyBDb21tb24uQ0VJTF9TSVpFO1xyXG4gICAgdGhpcy5oZWFkLnN0eWxlLmxlZnQgPSBgJHtoZWFkTmV3WH1weGA7XHJcbiAgfVxyXG4gIHN0ZXBVcCgpIDogdm9pZCB7XHJcbiAgICBjb25zdCBoZWFkTmV3WSA9IHRoaXMuaGVhZC5vZmZzZXRUb3AgLSBDb21tb24uQ0VJTF9TSVpFO1xyXG4gICAgdGhpcy5oZWFkLnN0eWxlLnRvcCA9IGAke2hlYWROZXdZfXB4YDtcclxuICB9XHJcbiAgc3RlcERvd24oKSA6IHZvaWQge1xyXG4gICAgY29uc3QgaGVhZE5ld1kgPSB0aGlzLmhlYWQub2Zmc2V0VG9wICsgQ29tbW9uLkNFSUxfU0laRTtcclxuICAgIHRoaXMuaGVhZC5zdHlsZS50b3AgPSBgJHtoZWFkTmV3WX1weGA7XHJcbiAgfVxyXG4gIHN0ZXAgPSAoKT0+e1xyXG4gICAgdGhpcy5yZWZyZXNoQm9keSgpO1xyXG4gICAgc3dpdGNoICh0aGlzLmRpcmVjdGlvbikge1xyXG4gICAgICBjYXNlICd1cCcgOiB7XHJcbiAgICAgICAgdGhpcy5zdGVwVXAoKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgICBjYXNlICdkb3duJzoge1xyXG4gICAgICAgIHRoaXMuc3RlcERvd24oKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgICBjYXNlICdsZWZ0Jzoge1xyXG4gICAgICAgIHRoaXMuc3RlcExlZnQoKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgICBjYXNlICdyaWdodCc6IHtcclxuICAgICAgICB0aGlzLnN0ZXBSaWdodCgpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIGRlZmF1bHQ6IHtcclxuICAgICAgICBjb25zdCBleGhhdXN0aXZlQ2hlY2sgOiBuZXZlciA9IHRoaXMuZGlyZWN0aW9uO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8vIOibh+WktOenu+WKqOS4gOagvOWQju+8jOWQjumdouS5n+mcgOimgei3n+S4iu+8iOWunumZheWwseaYr+S7juacgOWQjuS4gOiKguW8gOWni++8jOiuqeavj+iKguetieS6juWJjeS4gOiKgueahOS9jee9ru+8iVxyXG4gIHByaXZhdGUgcmVmcmVzaEJvZHkoKTogdm9pZCB7XHJcbiAgICBsZXQgYm9keVNlY3Rpb25zID0gdGhpcy5lbGVtZW50LmNoaWxkcmVuO1xyXG4gICAgaWYgKGJvZHlTZWN0aW9ucy5sZW5ndGggPD0gMSkgeyAgLy8g5Y+q5pyJ6JuH5aS077yM5rKh5pyJ5YW25LuW6YOo5YiG77yM5LiN6ZyA6KaB6KGl6b2QXHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGZvciAobGV0IGkgPSBib2R5U2VjdGlvbnMubGVuZ3RoLTE7IGkgPiAwOyBpLS0pIHtcclxuICAgICAgY29uc3QgbmV4dCA9IGJvZHlTZWN0aW9uc1tpLTFdIGFzIEhUTUxFbGVtZW50O1xyXG4gICAgICBsZXQgY3VycmVudCA9IGJvZHlTZWN0aW9uc1tpXSBhcyBIVE1MRWxlbWVudDtcclxuICAgICAgY29uc3QgbmV4dFggPSBuZXh0Lm9mZnNldExlZnQ7XHJcbiAgICAgIGNvbnN0IG5leHRZID0gbmV4dC5vZmZzZXRUb3A7XHJcbiAgICAgIGN1cnJlbnQuc3R5bGUubGVmdCA9IGAke25leHRYfXB4YDtcclxuICAgICAgY3VycmVudC5zdHlsZS50b3AgPSBgJHtuZXh0WX1weGA7XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8vIOW9k+WQg+WIsOmjn+eJqeWQjui6q+S9k+WinumVv+S4gOiKglxyXG4gIGdyb3coKTogdm9pZCB7XHJcbiAgICAvLyDmoLnmja7lvZPliY3mnIDlkI7kuIDoioLnmoTkvY3nva7lkoznp7vliqjmlrnlkJHnoa7lrprmlrDoioLnmoTkvY3nva5cclxuICAgIGNvbnN0IGN1cnJMYXN0U2VjdGlvbiA9IHRoaXMuZWxlbWVudC5sYXN0RWxlbWVudENoaWxkIGFzIEhUTUxFbGVtZW50O1xyXG4gICAgbGV0IG5ld1NlY3Rpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIG5ld1NlY3Rpb24uaWQgPSAnc25ha2UtYm9keSc7XHJcbiAgICBsZXQgbmV3U2VjWCA9IGN1cnJMYXN0U2VjdGlvbi5vZmZzZXRMZWZ0O1xyXG4gICAgbGV0IG5ld1NlY1kgPSBjdXJyTGFzdFNlY3Rpb24ub2Zmc2V0VG9wO1xyXG4gICAgc3dpdGNoICh0aGlzLmRpcmVjdGlvbikge1xyXG4gICAgICBjYXNlICd1cCc6IHsgIC8vIOWQkeS4iuaWueWQke+8jOaWsOiKguWcqOacgOWQjuS4gOiKgueahOS4i+mdouS4gOagvOS9jee9rlxyXG4gICAgICAgIG5ld1NlY1kgKz0gQ29tbW9uLkNFSUxfU0laRTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgICBjYXNlICdkb3duJzogeyAgLy8g5ZCR5LiL5pa55ZCR77yM5paw6IqC5Zyo5pyA5ZCO5LiA6IqC55qE5LiK6Z2i5LiA5qC85L2N572uXHJcbiAgICAgICAgbmV3U2VjWSAtPSBDb21tb24uQ0VJTF9TSVpFO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIGNhc2UgJ2xlZnQnOiB7ICAvLyDlkJHlt6bmlrnlkJHvvIzmlrDoioLlnKjmnIDlkI7kuIDoioLnmoTlj7PovrnkuIDmoLzkvY3nva5cclxuICAgICAgICBuZXdTZWNYICs9IENvbW1vbi5DRUlMX1NJWkU7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgICAgY2FzZSAncmlnaHQnOiB7IC8vIOWQkeWPs+aWueWQke+8jOaWsOiKguWcqOacgOWQjuS4gOiKgueahOW3pui+ueS4gOagvOS9jee9rlxyXG4gICAgICAgIG5ld1NlY1ggLT0gQ29tbW9uLkNFSUxfU0laRTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgICBkZWZhdWx0OiB7XHJcbiAgICAgICAgY29uc3QgZXhoYXVzdGl2ZUNoZWNrIDogbmV2ZXIgPSB0aGlzLmRpcmVjdGlvbjtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgbmV3U2VjdGlvbi5zdHlsZS5sZWZ0ID0gYCR7bmV3U2VjWH1weGA7XHJcbiAgICBuZXdTZWN0aW9uLnN0eWxlLnRvcCA9IGAke25ld1NlY1l9cHhgO1xyXG4gICAgdGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKG5ld1NlY3Rpb24pO1xyXG4gIH1cclxuICAvLyDliKTmlq3lpLTpg6jmnInmsqHmnInmkp7liLDoh6rlt7HnmoTouqvkvZNcclxuICBjaGVja1RvdWNoU2VsZiA9ICgpPT57XHJcbiAgICBsZXQgYm9keVNlY3Rpb25zID0gdGhpcy5lbGVtZW50LmNoaWxkcmVuO1xyXG4gICAgZm9yIChsZXQgaSA9IGJvZHlTZWN0aW9ucy5sZW5ndGgtMTsgaSA+IDA7IGktLSkge1xyXG4gICAgICBsZXQgc2VjID0gYm9keVNlY3Rpb25zW2ldIGFzIEhUTUxFbGVtZW50O1xyXG4gICAgICBpZiAodGhpcy5YICogQ29tbW9uLkNFSUxfU0laRSA9PT0gc2VjLm9mZnNldExlZnQgJiZcclxuICAgICAgICAgIHRoaXMuWSAqIENvbW1vbi5DRUlMX1NJWkUgPT09IHNlYy5vZmZzZXRUb3ApIHtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgU25ha2U7IiwiaW1wb3J0IENvbW1vbiBmcm9tICcuL2NvbW1vbidcclxuY2xhc3MgRm9vZCB7XHJcbiAgZWxlbWVudDogSFRNTEVsZW1lbnQ7XHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICB0aGlzLmVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9vZCcpIGFzIEhUTUxFbGVtZW50O1xyXG4gIH1cclxuICAvLyDojrflj5bpo5/niannmoR45Z2Q5qCHXHJcbiAgZ2V0IFgoKSB7XHJcbiAgICByZXR1cm4gTWF0aC5mbG9vcih0aGlzLmVsZW1lbnQub2Zmc2V0TGVmdCAvIENvbW1vbi5DRUlMX1NJWkUpO1xyXG4gIH1cclxuICAvLyDojrflj5bpo5/niannmoR55Z2Q5qCHXHJcbiAgZ2V0IFkoKSB7XHJcbiAgICByZXR1cm4gTWF0aC5mbG9vcih0aGlzLmVsZW1lbnQub2Zmc2V0VG9wIC8gQ29tbW9uLkNFSUxfU0laRSk7XHJcbiAgfVxyXG4gIC8vIOmjn+eJqeiiq+WQg+WQjumcgOimgeaWsOW7uumjn+eJqe+8iOaUueWPmGZvb2TlhYPntKDnmoTkvY3nva7vvIlcclxuICBjaGFuZ2UoKSB7XHJcbiAgICBsZXQgbmV3WCA9IDEwICogTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKENvbW1vbi5OIC0gMSkpO1xyXG4gICAgbGV0IG5ld1kgPSAxMCAqIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChDb21tb24uTiAtIDEpKTtcclxuICAgIHRoaXMuZWxlbWVudC5zdHlsZS5sZWZ0ID0gYCR7bmV3WH1weGA7XHJcbiAgICB0aGlzLmVsZW1lbnQuc3R5bGUudG9wID0gYCR7bmV3WX1weGA7XHJcbiAgfVxyXG59XHJcblxyXG4vLyDmtYvor5Xku6PnoIFcclxuLy8gY29uc3QgZm9vZCA9IG5ldyBGb29kKCk7XHJcbi8vIGNvbnNvbGUubG9nKGZvb2QuWCwgZm9vZC5ZKTtcclxuXHJcblxyXG5leHBvcnQgZGVmYXVsdCBGb29kOyIsImltcG9ydCBTbmFrZSBmcm9tICcuL3NuYWtlJztcclxuaW1wb3J0IEZvb2QgZnJvbSAnLi9mb29kJztcclxuaW1wb3J0IENvbW1vbiBmcm9tICcuL2NvbW1vbic7XHJcblxyXG5jb25zdCBtYXAgPSBuZXcgTWFwKCk7ICAvLyBrZXnkuLrmjInplK7vvIx2YWx1ZeS4uuaWueWQkVxyXG5tYXAuc2V0KCdBcnJvd1VwJywgJ3VwJyk7XHJcbm1hcC5zZXQoJ0Fycm93RG93bicsICdkb3duJyk7XHJcbm1hcC5zZXQoJ0Fycm93TGVmdCcsICdsZWZ0Jyk7XHJcbm1hcC5zZXQoJ0Fycm93UmlnaHQnLCAncmlnaHQnKTtcclxuXHJcbmNsYXNzIEdhbWUge1xyXG4gIHNuYWtlOiBTbmFrZTtcclxuICBsZXZlbEVsZW1lbnQ6IEhUTUxFbGVtZW50O1xyXG4gIHNjb3JlRWxlbWVudDogSFRNTEVsZW1lbnQ7XHJcbiAgZm9vZDogRm9vZDtcclxuICBpc0xpdmU6IGJvb2xlYW47XHJcbiAgY29uc3RydWN0b3IoKSB7XHJcblxyXG4gICAgdGhpcy5zbmFrZSA9IG5ldyBTbmFrZSgpO1xyXG4gICAgdGhpcy5zY29yZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2NvcmUnKTtcclxuICAgIHRoaXMubGV2ZWxFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xldmVsJyk7XHJcbiAgICB0aGlzLmZvb2QgPSBuZXcgRm9vZCgpO1xyXG4gICAgdGhpcy5pc0xpdmUgPSB0cnVlO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBtb3ZlU25ha2UgPSAoKT0+e1xyXG4gICAgY29uc3QgbGV2ZWwgOiBudW1iZXIgPSBOdW1iZXIucGFyc2VJbnQodGhpcy5sZXZlbEVsZW1lbnQuaW5uZXJUZXh0KTtcclxuICAgIGxldCB0aW1lciA9IHNldEludGVydmFsKCgpPT57XHJcbiAgICAgIHRoaXMuc25ha2Uuc3RlcCgpO1xyXG4gICAgICB0aGlzLmNoZWNrU2NvcmUoKTtcclxuICAgICAgdGhpcy5jaGVja1RvdWNoV2FsbCgpO1xyXG4gICAgICBpZiAodGhpcy5zbmFrZS5jaGVja1RvdWNoU2VsZigpKSB7XHJcbiAgICAgICAgdGhpcy5pc0xpdmUgPSBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5pc0xpdmUgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgbGV0IGdhbWVTdGF0dXNFbGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZ2FtZS1zdGF0dXMnKTtcclxuICAgICAgICBnYW1lU3RhdHVzRWxlLmlubmVyVGV4dCA9ICdnYW1lIGZhaWxlZCEnO1xyXG4gICAgICAgIGNsZWFySW50ZXJ2YWwodGltZXIpO1xyXG4gICAgICB9XHJcbiAgICB9LCAzMDAgLSAyMCoobGV2ZWwtMSkpO1xyXG4gIH1cclxuICBwcml2YXRlIGNoZWNrU2NvcmUgPSAoKT0+e1xyXG4gICAgY29uc3QgZm9vZFggPSB0aGlzLmZvb2QuWDtcclxuICAgIGNvbnN0IGZvb2RZID0gdGhpcy5mb29kLlk7XHJcbiAgICBjb25zdCBzbmFrZUhlYWRYID0gdGhpcy5zbmFrZS5YO1xyXG4gICAgY29uc3Qgc25ha2VIZWFkWSA9IHRoaXMuc25ha2UuWTtcclxuICAgIGlmIChmb29kWCA9PT0gc25ha2VIZWFkWCAmJiBmb29kWSA9PT0gc25ha2VIZWFkWSkgeyAgLy8g5ZCD5Yiw6aOf54mp5LqGXHJcbiAgICAgIC8vIOabtOaWsOWIhuaVsFxyXG4gICAgICBjb25zdCBuZXdTY29yZSA9IE51bWJlci5wYXJzZUludCh0aGlzLnNjb3JlRWxlbWVudC5pbm5lclRleHQpICsgMTtcclxuICAgICAgdGhpcy5zY29yZUVsZW1lbnQuaW5uZXJUZXh0ID0gU3RyaW5nKG5ld1Njb3JlKTtcclxuICAgICAgLy8g5pu05pawbGV2ZWxcclxuICAgICAgaWYgKG5ld1Njb3JlICUgMTAgPT09IDApIHtcclxuICAgICAgICBjb25zdCBuZXdMZXZlbCA9IE51bWJlci5wYXJzZUludCh0aGlzLmxldmVsRWxlbWVudC5pbm5lclRleHQpICsgMTtcclxuICAgICAgICBpZiAobmV3TGV2ZWwgPD0gMTApIHtcclxuICAgICAgICAgIHRoaXMubGV2ZWxFbGVtZW50LmlubmVyVGV4dCA9IFN0cmluZyhuZXdMZXZlbCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIC8vIOibh+i6q+S9k+WinumVv+S4gOiKglxyXG4gICAgICB0aGlzLnNuYWtlLmdyb3coKTtcclxuICAgICAgLy8g5pu05paw6aOf54mpXHJcbiAgICAgIHRoaXMuZm9vZC5jaGFuZ2UoKTtcclxuICAgIH1cclxuICB9O1xyXG4gIC8vIOeisOWimeajgOa1i1xyXG4gIHByaXZhdGUgY2hlY2tUb3VjaFdhbGwgPSAoKT0+e1xyXG4gICAgY29uc3Qgc25ha2VIZWFkWCA9IHRoaXMuc25ha2UuWDtcclxuICAgIGNvbnN0IHNuYWtlSGVhZFkgPSB0aGlzLnNuYWtlLlk7XHJcbiAgICBpZiAoc25ha2VIZWFkWCA+PSBDb21tb24uTiB8fCBzbmFrZUhlYWRYIDwgMCB8fFxyXG4gICAgICAgIHNuYWtlSGVhZFkgPj0gQ29tbW9uLk4gfHwgc25ha2VIZWFkWSA8IDApIHtcclxuICAgICAgdGhpcy5pc0xpdmUgPSBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcbiAgcHVibGljIHBsYXkgPSAoKT0+e1xyXG4gICAgbGV0IHNlbGYgPSB0aGlzO1xyXG4gICAgdGhpcy5tb3ZlU25ha2UoKTtcclxuICAgIGZ1bmN0aW9uIGtleURvd25IYW5kbGVyKGV2ZW50OiBLZXlib2FyZEV2ZW50KSA6IHZvaWQge1xyXG4gICAgICBsZXQga2V5ID0gZXZlbnQua2V5O1xyXG4gICAgICAvLyDnjrDlnKjmmK/lnoLnm7TmlrnlkJHvvIzlj6rog73lt6blj7PmjInplK7mlLnlj5jmlrnlkJFcclxuICAgICAgLy8g546w5Zyo5piv5rC05bmz5pa55ZCR77yM5YiZ5Y+q6IO95Z6C55u05pa55ZCR5oyJ6ZSu5pS55Y+Y5pa55ZCRXHJcbiAgICAgIGlmICgoc2VsZi5zbmFrZS5kaXJlY3Rpb24gPT09ICd1cCcgfHwgc2VsZi5zbmFrZS5kaXJlY3Rpb24gPT09ICdkb3duJykgJiZcclxuICAgICAgICAgIChrZXkgPT09ICdBcnJvd0xlZnQnIHx8IGtleSA9PT0gJ0Fycm93UmlnaHQnKSkge1xyXG4gICAgICAgIHNlbGYuc25ha2UuZGlyZWN0aW9uID0gbWFwLmdldChrZXkpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICgoc2VsZi5zbmFrZS5kaXJlY3Rpb24gPT09ICdsZWZ0JyB8fCBzZWxmLnNuYWtlLmRpcmVjdGlvbiA9PT0gJ3JpZ2h0JykgJiZcclxuICAgICAgICAgIChrZXkgPT09ICdBcnJvd1VwJyB8fCBrZXkgPT09ICdBcnJvd0Rvd24nKSkge1xyXG4gICAgICAgIHNlbGYuc25ha2UuZGlyZWN0aW9uID0gbWFwLmdldChrZXkpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBsZXQgZm4gPSBDb21tb24uZGVib3VuY2VEZWNvcmF0b3Ioa2V5RG93bkhhbmRsZXIsIDEwMClcclxuICAgIC8vIOWKoOW7tui/n+OAgumBv+WFjeeUqOaIt+i/hemAn+aMieS4i+S4pOS4qumUru+8iOavlOWmguW9k+WJjeW3puenu+WKqO+8jOeUqOaIt+aMieS4i+S4iumUruWPiOeri+WNs+aMieS4i+WPs+mUru+8iVxyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGZuKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEdhbWU7IiwiaW1wb3J0IEdhbWUgZnJvbSAnLi9nYW1lJztcclxuXHJcbmxldCBnYW1lID0gbmV3IEdhbWUoKTtcclxuZ2FtZS5wbGF5KCk7Il0sInNvdXJjZVJvb3QiOiIifQ==